<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plan de Entrenamiento Interactivo - Sebastian Diaz Gallardo</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /*<!-- Chosen Palette: Calm Neutrals -->*/
        /*<!-- Application Structure Plan: La aplicaci√≥n est√° dise√±ada como un panel de control de una sola p√°gina con navegaci√≥n por pesta√±as. Se ha unificado el "Panel de Control" y "Mi Plan" en una √∫nica pesta√±a "Mi Plan" para una experiencia m√°s cohesiva y simplificada. Esta arquitectura ahora centraliza toda la informaci√≥n procesable (plan diario, progreso semanal, detalles de entrenamiento) en un solo lugar, mientras que el contenido de referencia (seguridad, fundamentos) permanece en pesta√±as separadas. Esta estructura est√° optimizada para la usabilidad y la adherencia, guiando al usuario a trav√©s de su viaje de recuperaci√≥n y fitness. -->*/
        /*<!-- Visualization & Content Choices: 
            - Perfil de Usuario y Resumen Diario -> Objetivo: Informar y procesar -> M√©todo: Tarjetas HTML dentro de la pesta√±a "Mi Plan" con campos de entrada interactivos para peso -> Interacci√≥n: El usuario puede modificar el peso y actualizar el IMC din√°micamente (en tiempo real); el slider de semana actualiza las tarjetas y el gr√°fico -> Justificaci√≥n: Vista inmediata de m√©tricas clave y plan del d√≠a en el contexto del plan general, con capacidad de simulaci√≥n de cambio de peso.
            - Plan de 12 Semanas -> Objetivo: Organizar y mostrar cambio -> M√©todo: Gr√°fico de l√≠neas interactivo (Chart.js) y tarjetas de entrenamiento semanales -> Interacci√≥n: El usuario selecciona la semana para actualizar las tarjetas y el gr√°fico -> Justificaci√≥n: Visualiza la progresi√≥n y proporciona pasos procesables para cada semana.
            - Pautas de Seguridad -> Objetivo: Informar y Organizar -> M√©todo: L√≠nea de tiempo/acorde√≥n HTML/CSS interactivo -> Interacci√≥n: Clic en una fase para expandir detalles -> Justificaci√≥n: Desglosa la informaci√≥n cr√≠tica de seguridad en fragmentos manejables y espec√≠ficos del contexto de recuperaci√≥n.
            - Ejercicios de Core -> Objetivo: Organizar e Instruir -> M√©todo: Acorde√≥n HTML -> Interacci√≥n: Clic para expandir detalles del ejercicio -> Justificaci√≥n: Presenta un plan de ejercicios progresivo sin abrumar al usuario.
            - Todos los gr√°ficos y diagramas se realizan con Canvas (a trav√©s de Chart.js) o HTML/CSS estructurado para evitar SVG.
        -->*/
        /*<!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->*/
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f4f4f5; /* zinc-100 */
            /* Removed background image for Zoro */
            color: #zinc-800; /* Default text color, adjust as needed for readability */
        }
        @import url('https://rsms.me/inter/inter.css');
        .tab-active {
            border-bottom-color: #2563eb; /* blue-600 */
            color: #1e3a8a; /* blue-900 */
            font-weight: 600;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            height: 450px; /* Increased height */
            max-height: 60vh; /* Increased max-height */
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 500px; /* Increased height for larger screens */
            }
        }
        /* Table styles for better readability (kept for general tables, but not for weight progress) */
        .styled-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            font-size: 0.9em;
            min-width: 400px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.15);
            border-radius: 8px;
            overflow: hidden; /* Ensures rounded corners apply to content */
        }
        .styled-table thead tr {
            background-color: #2563eb; /* blue-600 */
            color: #ffffff;
            text-align: left;
        }
        .styled-table th,
        .styled-table td {
            padding: 12px 15px;
            border: 1px solid #dddddd;
        }
        .styled-table tbody tr {
            border-bottom: 1px solid #dddddd;
        }
        .styled-table tbody tr:nth-of-type(even) {
            background-color: #f3f3f3;
        }
        .styled-table tbody tr:last-of-type {
            border-bottom: 2px solid #2563eb; /* blue-600 */
        }
        .styled-table tbody tr.active-row {
            font-weight: bold;
            color: #2563eb; /* blue-600 */
        }
        /* Reverted transparency for content blocks */
        .bg-white {
            background-color: #ffffff;
        }
        .bg-zinc-50 {
            background-color: #fafafa; /* zinc-50 */
        }
        .bg-blue-50 {
            background-color: #eff6ff; /* blue-50 */
        }
        .bg-yellow-50 {
            background-color: #fffbeb; /* yellow-50 */
        }
        header, footer {
            background-color: #ffffff; /* white */
        }
    </style>
</head>
<body class="bg-zinc-100 text-zinc-800">

    <header class="bg-white shadow-md sticky top-0 z-10">
        <div class="container mx-auto px-4 py-4">
            <h1 class="text-2xl md:text-3xl font-bold text-blue-900">Plan de Entrenamiento Interactivo</h1>
            <p class="text-md text-zinc-600">Sebastian Diaz Gallardo</p>
        </div>
    </header>

    <main class="container mx-auto p-4 md:p-6">
        <!-- Welcome Message -->
        <div class="bg-white p-6 rounded-lg shadow-sm text-center mb-6">
            <h2 class="text-2xl font-bold text-blue-800 mb-4">¬°Bienvenido, Sebasti√°n!</h2>
            <ul class="list-disc list-inside text-zinc-700 space-y-2">
                <li>Hoy marcas el inicio de un viaje que no solo transformar√° tu salud, sino tambi√©n tu forma de vivir, sentir y conectarte contigo mismo. Este es tu momento.</li>
                <li>Est√°s por iniciar un camino de sanaci√≥n y crecimiento, donde cuerpo, mente y alma se alinean para llevarte hacia una vida m√°s consciente y plena.</li>
                <li>Tu transformaci√≥n comienza hoy: m√°s energ√≠a, mejor salud, y claridad para alcanzar todo lo que te propones. Este camino est√° hecho a tu medida.</li>
            </ul>
        </div>

        <nav class="bg-white rounded-lg shadow-sm mb-6">
            <div class="flex border-b border-zinc-200">
                <button class="tab-btn flex-1 py-3 px-2 text-center text-sm md:text-base text-zinc-600 border-b-2 border-transparent hover:bg-zinc-50" data-tab="plan">
                    <span class="hidden sm:inline">üóìÔ∏è</span> Mi Plan y Progreso
                </button>
                <button class="tab-btn flex-1 py-3 px-2 text-center text-sm md:text-base text-zinc-600 border-b-2 border-transparent hover:bg-zinc-50" data-tab="safety">
                    <span class="hidden sm:inline">üõ°Ô∏è</span> Seguridad y Core
                </button>
                <button class="tab-btn flex-1 py-3 px-2 text-center text-sm md:text-base text-zinc-600 border-b-2 border-transparent hover:bg-zinc-50" data-tab="science">
                    <span class="hidden sm:inline">üî¨</span> Fundamentos
                </button>
            </div>
        </nav>

        <div id="content-area">
        </div>
    </main>
    
    <footer class="text-center py-6 text-sm text-zinc-500">
        <p>Este plan es una gu√≠a. Escucha siempre a tu cuerpo y consulta a tu m√©dico.</p>
    </footer>

    <script>
        const appState = {
            currentTab: 'plan', // Default to 'plan' tab
            currentWeek: 1, 
            selectedWeightWeek: 1, // New state variable for selected week in weight input
        };

        const userData = {
            name: "Sebastian Diaz Gallardo",
            age: 32,
            weight: 88.6,
            height: 167, // height in cm
            imc: 31.6,
            condition: "Obesidad Tipo 1",
            surgery: "Hernioplastia crural simple sin malla (finales de Abril 2025)"
        };

        const planData = [
            // Semanas 1-12
            {
                week: 1,
                phase: 1,
                treadmill: {
                    warmup: { duration: 5, speed: "3.0-4.0", incline: "0¬∞", activity: "Caminata suave y movimientos articulares" },
                    main: { type: "LISS (Caminata)", duration_total: 20, speed: "4.0-5.0", incline: "0-1¬∞", description: "Mant√©n un ritmo constante y c√≥modo." },
                    cooldown: { duration: 5, speed: "3.0-4.0", incline: "0¬∞", activity: "Caminata suave y estiramientos" }
                }
            },
            {
                week: 2,
                phase: 1,
                treadmill: {
                    warmup: { duration: 5, speed: "3.0-4.0", incline: "0¬∞", activity: "Caminata suave y movimientos articulares" },
                    main: { type: "LISS (Caminata)", duration_total: 25, speed: "4.0-5.0", incline: "0-1¬∞", description: "Mant√©n un ritmo constante y c√≥modo." },
                    cooldown: { duration: 5, speed: "3.0-4.0", incline: "0¬∞", activity: "Caminata suave y estiramientos" }
                }
            },
            {
                week: 3,
                phase: 1,
                treadmill: {
                    warmup: { duration: 5, speed: "3.0-4.0", incline: "0¬∞", activity: "Caminata suave y movimientos articulares" },
                    main: { type: "LISS (Caminata)", duration_total: 25, speed: "4.5-5.5", incline: "1-2¬∞", description: "Aumenta ligeramente la velocidad e inclinaci√≥n si te sientes c√≥modo." },
                    cooldown: { duration: 5, speed: "3.0-4.0", incline: "0¬∞", activity: "Caminata suave y estiramientos" }
                }
            },
            {
                week: 4,
                phase: 1,
                treadmill: {
                    warmup: { duration: 5, speed: "3.0-4.0", incline: "0¬∞", activity: "Caminata suave y movimientos articulares" },
                    main: { type: "LISS (Caminata)", duration_total: 30, speed: "4.5-5.5", incline: "1-2¬∞", description: "Mant√©n la duraci√≥n y eval√∫a tu comodidad con la inclinaci√≥n." },
                    cooldown: { duration: 5, speed: "3.0-4.0", incline: "0¬∞", activity: "Caminata suave y estiramientos" }
                }
            },
            {
                week: 5,
                phase: 2,
                treadmill: {
                    warmup: { duration: 5, speed: "3.0-4.0", incline: "0¬∞", activity: "Caminata suave y movimientos articulares" },
                    main: { type: "MISS (Caminata/Trote Ligero)", duration_total: 30, speed: "5.5-6.5", incline: "2-3¬∞", description: "Introduce intervalos muy cortos de trote ligero (ej. 30 seg trote, 2 min caminata) if no hay dolor." },
                    cooldown: { duration: 5, speed: "3.0-4.0", incline: "0¬∞", activity: "Caminata suave y estiramientos" }
                }
            },
            {
                week: 6,
                phase: 2,
                treadmill: {
                    warmup: { duration: 5, speed: "3.0-4.0", incline: "0¬∞", activity: "Caminata suave y movimientos articulares" },
                    main: { type: "MISS (Caminata/Trote Ligero)", duration_total: 35, speed: "5.5-6.5", incline: "2-3¬∞", description: "Aumenta la duraci√≥n de los intervalos de trote if te sientes bien." },
                    cooldown: { duration: 5, speed: "3.0-4.0", incline: "0¬∞", activity: "Caminata suave y estiramientos" }
                }
            },
            {
                week: 7,
                phase: 2,
                treadmill: {
                    warmup: { duration: 5, speed: "3.0-4.0", incline: "0¬∞", activity: "Caminata suave y movimientos articulares" },
                    main: { type: "MISS (Caminata/Trote Ligero)", duration_total: 35, speed: "6.0-7.0", incline: "3-5¬∞", description: "Prioriza la inclinaci√≥n sobre la velocidad para aumentar la intensidad con bajo impacto." },
                    cooldown: { duration: 5, speed: "3.0-4.0", incline: "0¬∞", activity: "Caminata suave y estiramientos" }
                }
            },
            {
                week: 8,
                phase: 2,
                treadmill: {
                    warmup: { duration: 5, speed: "3.0-4.0", incline: "0¬∞", activity: "Caminata suave y movimientos articulares" },
                    main: { type: "MISS (Caminata/Trote Ligero)", duration_total: 40, speed: "6.0-7.0", incline: "3-5¬∞", description: "Mant√©n la duraci√≥n y la intensidad, prepar√°ndote para la siguiente fase." },
                    cooldown: { duration: 5, speed: "3.0-4.0", incline: "0¬∞", activity: "Caminata suave y estiramientos" }
                }
            },
            {
                week: 9,
                phase: 3,
                treadmill: {
                    warmup: { duration: 5, speed: "3.0-4.0", incline: "0¬∞", activity: "Caminata suave y movimientos articulares" },
                    main: {
                        type: "HIIT + MISS",
                        intervalos: 8,
                        esfuerzo_duration: "1 min",
                        esfuerzo_speed: "10-12",
                        esfuerzo_incline: "0-1¬∞",
                        recuperacion_duration: "2 min",
                        recuperacion_speed: "5-7",
                        recuperacion_incline: "0-1¬∞",
                        miss_duration: 40,
                        miss_speed: "6.0-7.0",
                        miss_incline: "5-8¬∞",
                        description: "Realiza 8 ciclos de HIIT, seguido de una sesi√≥n de MISS."
                    },
                    cooldown: { duration: 5, speed: "3.0-4.0", incline: "0¬∞", activity: "Caminata suave y estiramientos" }
                }
            },
            {
                week: 10,
                phase: 3,
                treadmill: {
                    warmup: { duration: 5, speed: "3.0-4.0", incline: "0¬∞", activity: "Caminata suave y movimientos articulares" },
                    main: {
                        type: "HIIT + MISS",
                        intervalos: 10,
                        esfuerzo_duration: "1 min",
                        esfuerzo_speed: "10-12",
                        esfuerzo_incline: "0-1¬∞",
                        recuperacion_duration: "2 min",
                        recuperacion_speed: "5-7",
                        recuperacion_incline: "0-1¬∞",
                        miss_duration: 45,
                        miss_speed: "6.0-7.0",
                        miss_incline: "5-8¬∞",
                        description: "Aumenta a 10 ciclos de HIIT, seguido de una sesi√≥n de MISS."
                    },
                    cooldown: { duration: 5, speed: "3.0-4.0", incline: "0¬∞", activity: "Caminata suave y estiramientos" }
                }
            },
            {
                week: 11,
                phase: 3,
                treadmill: {
                    warmup: { duration: 5, speed: "3.0-4.0", incline: "0¬∞", activity: "Caminata suave y movimientos articulares" },
                    main: {
                        type: "HIIT + MISS/LISS",
                        intervalos: 12,
                        esfuerzo_duration: "1 min",
                        esfuerzo_speed: "12-15",
                        esfuerzo_incline: "0-2¬∞",
                        recuperacion_duration: "2 min",
                        recuperacion_speed: "6-8",
                        recuperacion_incline: "0-2¬∞",
                        miss_liss_duration: 45,
                        miss_liss_speed: "6.0-8.0",
                        miss_liss_incline: "8-10¬∞",
                        description: "Incrementa a 12 ciclos de HIIT con mayor velocidad e inclinaci√≥n. Contin√∫a con MISS/LISS."
                    },
                    cooldown: { duration: 5, speed: "3.0-4.0", incline: "0¬∞", activity: "Caminata suave y estiramientos" }
                }
            },
            {
                week: 12,
                phase: 3,
                treadmill: {
                    warmup: { duration: 5, speed: "3.0-4.0", incline: "0¬∞", activity: "Caminata suave y movimientos articulares" },
                    main: {
                        type: "HIIT + MISS/LISS",
                        intervalos: 15,
                        esfuerzo_duration: "1 min",
                        esfuerzo_speed: "12-15",
                        esfuerzo_incline: "0-2¬∞",
                        recuperacion_duration: "2 min",
                        recuperacion_speed: "6-8",
                        recuperacion_incline: "0-2¬∞",
                        miss_liss_duration: 50,
                        miss_liss_speed: "6.0-8.0",
                        miss_liss_incline: "8-10¬∞",
                        description: "M√°xima progresi√≥n de HIIT con 15 ciclos. Finaliza con una sesi√≥n m√°s larga de MISS/LISS."
                    },
                    cooldown: { duration: 5, speed: "3.0-4.0", incline: "0¬∞", activity: "Caminata suave y estiramientos" }
                }
            },
        ];

        const strengthData = {
            phase1: {
                title: "Fase 1: Recuperaci√≥n (Semanas 1-4)",
                description: "Enfoque en la cicatrizaci√≥n. Solo ejercicios de core muy suaves. Sin levantamiento de pesas.",
                exercises: [
                    { name: "Ejercicios de Core (Tabla 2)", sets: "3-4", reps: "10-15 reps/30-60 seg", note: "Solo los ejercicios de nivel inicial." }
                ]
            },
            phase2: {
                title: "Fase 2: Progresi√≥n (Semanas 5-8)",
                description: "Introducci√≥n cautelosa de fuerza con peso corporal o bandas de resistencia.",
                exercises: [
                    { name: "Sentadillas (Asistida a silla)", sets: "3", reps: "10-15", note: "Controlar el rango de movimiento." },
                    { name: "Flexiones de Pared/Rodillas", sets: "3", reps: "8-15", note: "Mantener core estable." },
                    { name: "Zancadas (Peso corporal)", sets: "3", reps: "8-12 por pierna", note: "Movimiento suave, sin dolor." },
                    { name: "Remo con Banda de Resistencia", sets: "3", reps: "12-15", note: "Evitar tensi√≥n abdominal." },
                    { name: "Ejercicios de Core (Tabla 2)", sets: "3-4", reps: "10-15 reps/30-60 seg", note: "Progresar a ejercicios intermedios if no hay dolor." }
                ]
            },
            phase3: {
                title: "Fase 3: Optimizaci√≥n (Semanas 9-12+)",
                description: "Reintroducci√≥n gradual de pesas y m√°quinas. Priorizar t√©cnica sobre peso. **Requiere aprobaci√≥n m√©dica expl√≠cita.**",
                exercises: [
                    { name: "Prensa de Piernas (M√°quina)", sets: "3", reps: "10-15", note: "Iniciar con peso muy ligero." },
                    { name: "Press de Pecho (M√°quina o mancuernas ligeras)", sets: "3", reps: "10-15", note: "Carga muy conservadora." },
                    { name: "Remo (M√°quina o mancuernas ligeras)", sets: "3", reps: "10-15", note: "Mantener espalda recta y core estable." },
                    { name: "Press de Hombros (Sentado, mancuernas ligeras)", sets: "3", reps: "10-15", note: "Espalda apoyada para estabilidad." },
                    { name: "Ejercicios de Core (Tabla 2)", sets: "3-4", reps: "10-15 reps/30-60 seg", note: "Progresar a avanzados con extrema precauci√≥n." }
                ]
            }
        };

        const coreExercisesData = [
            { exercise: "Inclinaci√≥n P√©lvica (Estabilizador Local)", description: "Acostado boca arriba, contraer abdomen para bascular pelvis hacia atr√°s, aplanando la espalda baja contra el suelo. Mantener la contracci√≥n durante 5-10 segundos.", progression: "Inicial", phase: "0-2 Semanas", notes: "Movimiento suave, enfoque en activaci√≥n profunda del transverso abdominal. No debe haber dolor." },
            { exercise: "Activaci√≥n del Transverso Abdominal (Estabilizador Local)", description: "De pie o sentado, lleva suavemente el ombligo hacia la columna vertebral, como si intentaras abrochar un pantal√≥n apretado, sin mover el tronco. Mantener 5-10 segundos.", progression: "Inicial", phase: "0-2 Semanas", notes: "Mantener respiraci√≥n normal y fluida. Evitar la Maniobra de Valsalva. Sensaci√≥n de 'faja' interna." },
            { exercise: "Respiraci√≥n Diafragm√°tica (Estabilizador Local)", description: "Acostado, coloca una mano en el pecho y otra en el abdomen. Inhala profundamente por la nariz, sintiendo c√≥mo se eleva el abdomen (no el pecho). Exhala lentamente por la boca. Enfocarse en la expansi√≥n abdominal.", progression: "Inicial", phase: "0-2 Semanas", notes: "Realizar frecuentemente (4+ veces/d√≠a). Ayuda a activar el diafragma, un m√∫sculo clave del core." },
            { exercise: "Toques de Tal√≥n Acostado (Estabilizador Global)", description: "Acostado boca arriba con rodillas flexionadas a 90¬∞, pies en el suelo. Mant√©n el core contra√≠do (ombligo hacia el suelo) y baja lentamente un tal√≥n hacia el suelo, sin que la espalda se arquee. Vuelve a la posici√≥n inicial y alterna.", progression: "Intermedio", phase: "2-6 Semanas", notes: "Controlar el movimiento. If la espalda se arquea, no bajes tanto la pierna. Priorizar la estabilidad del core." },
            { exercise: "Bird-Dog (Estabilizador Global)", description: "En posici√≥n de cuadrupedia (manos bajo hombros, rodillas bajo caderas). Extiende lentamente un brazo hacia adelante y la pierna opuesta hacia atr√°s, manteniendo la espalda recta y el core estable. Evita la rotaci√≥n de la cadera. Mantener 3-5 segundos.", progression: "Intermedio", phase: "2-6 Semanas", notes: "Movimiento lento y controlado. Evitar hiperextensi√≥n de la columna lumbar. El core debe permanecer inm√≥vil." },
            { exercise: "Gato/Vaca (Movilidad y Estabilidad)", description: "En cuadrupedia, redondear la espalda (posici√≥n de gato) llevando el ombligo hacia la columna, luego arquear suavemente la espalda (posici√≥n de vaca) sin dejar caer el abdomen. Movimientos fluidos.", progression: "Intermedio", phase: "2-6 Semanas", notes: "Movimientos suaves y controlados, sincronizados con la respiraci√≥n. No forzar el rango if hay dolor." },
            { exercise: "Plancha (Plank) (Estabilizador Global)", description: "Mantener el cuerpo en l√≠nea recta desde la cabeza hasta los talones, apoy√°ndose en los antebrazos y las puntas de los pies (o rodillas para progresi√≥n inicial). Mantener el abdomen contra√≠do.", progression: "Inicial: sobre rodillas. Intermedio: rodillas elevadas. Avanzado: plancha completa.", phase: "6+ Semanas (con aprobaci√≥n)", notes: "Mantener l√≠nea recta, no arquear espalda baja ni subir demasiado la cadera. Progresar lentamente la duraci√≥n (ej. 20-60 segundos)." },
            { exercise: "Puente de Gl√∫teos (Glute Bridge) (Estabilizador Global)", description: "Acostado boca arriba, rodillas flexionadas, pies en el suelo. Elevar las caderas del suelo contrayendo los gl√∫teos hasta formar una l√≠nea recta desde los hombros hasta las rodillas. Mantener 2-3 segundos.", progression: "Intermedio a Avanzado", phase: "6+ Semanas (con aprobaci√≥n)", notes: "Enfocarse en la contracci√≥n de gl√∫teos y core. Evitar hiperextensi√≥n lumbar. √ötil para fortalecer la cadena posterior." },
            { exercise: "Dead Bug (Estabilizador Global)", description: "Acostado boca arriba, rodillas flexionadas a 90¬∞, brazos extendidos hacia el techo. Baja lentamente el brazo derecho y la pierna izquierda hacia el suelo al mismo tiempo, manteniendo la espalda baja pegada al suelo. Regresa y alterna.", progression: "Avanzado", phase: "6+ Semanas (con aprobaci√≥n y extrema precauci√≥n)", notes: "Controlar la zona lumbar para que no se arquee. Movimiento lento y deliberado. If la espalda se arquea, no bajes tanto las extremidades." },
            { exercise: "Crunches (Abdominales) (Estabilizador Global)", description: "Elevar cabeza/hombros del suelo, contrayendo el abdomen. NO tirar del cuello.", progression: "Inicial: Chin tuck. Intermedio: Rodillas elevadas. Avanzado: Crunch completo.", phase: "6+ Semanas (con aprobaci√≥n)", notes: "MUY gradual. Detener if hay dolor o presi√≥n. Evitar Valsalva. La calidad del movimiento es m√°s importante que la cantidad." },
            { exercise: "Flutter Kicks (Estabilizador Global)", description: "Acostado boca arriba, piernas extendidas. Realiza peque√±as patadas de aleteo con las piernas, manteniendo la espalda baja pegada al suelo y el core contra√≠do.", progression: "Inicial: Elevaci√≥n de una pierna (45¬∞). Intermedio: Apoyo en codos. Avanzado: Sin apoyo de manos.", phase: "6+ Semanas (con aprobaci√≥n)", notes: "Mantener el core apretado, ombligo hacia la columna. If la espalda se arquea, eleva m√°s las piernas o reduce el rango de movimiento." },
            { exercise: "Ejercicios Oblicuos (Estabilizador Global)", description: "Inclinaciones laterales controladas para trabajar los m√∫sculos oblicuos.", progression: "Inicial: Acostado, alcanzar talones. Intermedio: De pie, inclinaci√≥n suave. Avanzado: De pie con pesas ligeras (1-2 lbs).", phase: "6+ Semanas (con aprobaci√≥n)", notes: "Controlar el movimiento, no forzar la rotaci√≥n ni la flexi√≥n lateral excesiva. Mantener el core activado." },
            { exercise: "Rodillo de Rodilla Inverso / Curl (Estabilizador Global)", description: "Acostado boca arriba, rodillas flexionadas hacia el pecho. Elevar las caderas del suelo rodando las rodillas hacia el pecho. Controlar el descenso.", progression: "Inicial: Rodillo de rodilla (solo movimiento de rodillas). Intermedio: Curl inverso (elevar caderas). Avanzado: Curl inverso completo (con extensi√≥n de piernas).", phase: "6+ Semanas (con aprobaci√≥n)", notes: "Movimientos lentos y controlados. Mantener el core contra√≠do para evitar tensi√≥n en la zona lumbar y quir√∫rgica." }
        ];

        const contentArea = document.getElementById('content-area');

        // Initialize weight progress data from localStorage or default
        let weightProgress = JSON.parse(localStorage.getItem('weightProgress')) || {};

        function saveWeightProgress() {
            localStorage.setItem('weightProgress', JSON.stringify(weightProgress));
        }

        function calculateIMC(weightKg, heightCm) {
            const heightM = heightCm / 100;
            return (weightKg / (heightM * heightM)).toFixed(1);
        }

        function getIMCCondition(imc) {
            if (imc < 18.5) return "Bajo peso";
            if (imc >= 18.5 && imc < 24.9) return "Peso normal";
            if (imc >= 25 && imc < 29.9) return "Sobrepeso";
            if (imc >= 30 && imc < 34.9) return "Obesidad Tipo 1";
            if (imc >= 35 && imc < 39.9) return "Obesidad Tipo 2";
            return "Obesidad Tipo 3";
        }

        function updateUserDataDisplay() {
            const weightInput = document.getElementById('weightInput');
            const imcDisplay = document.getElementById('imcDisplay');
            const conditionDisplay = document.getElementById('conditionDisplay');

            if (weightInput && !isNaN(parseFloat(weightInput.value))) {
                userData.weight = parseFloat(weightInput.value);
                userData.imc = calculateIMC(userData.weight, userData.height);
                userData.condition = getIMCCondition(userData.imc);

                imcDisplay.textContent = userData.imc;
                conditionDisplay.textContent = userData.condition;
            }
        }

        function updateSummaryCards(week) {
            const currentPlan = planData.find(p => p.week === week);
            const currentPhaseData = `phase${currentPlan.phase}`;
            const currentStrengthPlan = strengthData[currentPhaseData];

            // Update Estado de Recuperaci√≥n card
            const recoveryStatusElement = document.getElementById('recoveryStatus');
            const recoveryFocusElement = document.getElementById('recoveryFocus');
            if (recoveryStatusElement && recoveryFocusElement) {
                recoveryStatusElement.textContent = currentStrengthPlan.title;
                recoveryFocusElement.textContent = `Foco: ${currentPlan.phase === 1 ? 'Cicatrizaci√≥n' : (currentPlan.phase === 2 ? 'Progresi√≥n controlada' : 'Rendimiento y fuerza')}`;
            }

            // Update Entrenamiento de Trotadora de Hoy card
            const treadmillWeekLabel = document.getElementById('treadmillWeekLabel');
            const warmupDetails = document.getElementById('warmupDetails');
            const mainExerciseDetails = document.getElementById('mainExerciseDetails');
            const cooldownDetails = document.getElementById('cooldownDetails');

            if (treadmillWeekLabel && warmupDetails && mainExerciseDetails && cooldownDetails) {
                treadmillWeekLabel.textContent = `üéØ Entrenamiento de Trotadora de Hoy (Semana ${week})`;
                
                warmupDetails.innerHTML = `
                    <p><strong>Duraci√≥n:</strong> ${currentPlan.treadmill.warmup.duration} min</p>
                    <p><strong>Actividad:</strong> ${currentPlan.treadmill.warmup.activity}. Incluye **ejercicios de movilidad articular controlada** y **estiramientos din√°micos** para preparar tus m√∫sculos.</p>
                    <p><strong>Velocidad:</strong> ${currentPlan.treadmill.warmup.speed} km/h</p>
                    <p><strong>Inclinaci√≥n:</strong> ${currentPlan.treadmill.warmup.incline}</p>
                `;

                if (currentPlan.treadmill.main.type.includes("HIIT")) {
                    mainExerciseDetails.innerHTML = `
                        <p><strong>Tipo:</strong> ${currentPlan.treadmill.main.type}</p>
                        <p><strong>Descripci√≥n:</strong> ${currentPlan.treadmill.main.description}</p>
                        <ul class="list-disc list-inside ml-4">
                            <li><strong>Intervalos:</strong> ${currentPlan.treadmill.main.intervalos} ciclos</li>
                            <li><strong>Esfuerzo:</strong> ${currentPlan.treadmill.main.esfuerzo_duration} a ${currentPlan.treadmill.main.esfuerzo_speed} km/h con ${currentPlan.treadmill.main.esfuerzo_incline} de inclinaci√≥n</li>
                            <li><strong>Recuperaci√≥n:</strong> ${currentPlan.treadmill.main.recuperacion_duration} a ${currentPlan.treadmill.main.recuperacion_speed} km/h con ${currentPlan.treadmill.main.recuperacion_incline} de inclinaci√≥n</li>
                            ${currentPlan.treadmill.main.miss_duration ? `<li><strong>Sesi√≥n MISS/LISS Adicional:</strong> ${currentPlan.treadmill.main.miss_duration || currentPlan.treadmill.main.miss_liss_duration} min a ${currentPlan.treadmill.main.miss_speed || currentPlan.treadmill.main.miss_liss_speed} km/h con ${currentPlan.treadmill.main.miss_incline || currentPlan.treadmill.main.miss_liss_incline} de inclinaci√≥n</li>` : ''}
                        </ul>
                    `;
                } else {
                    mainExerciseDetails.innerHTML = `
                        <p><strong>Tipo:</strong> ${currentPlan.treadmill.main.type}</p>
                        <p><strong>Duraci√≥n:</strong> ${currentPlan.treadmill.main.duration_total} min</p>
                        <p><strong>Velocidad:</strong> ${currentPlan.treadmill.main.speed} km/h</p>
                        <p><strong>Inclinaci√≥n:</strong> ${currentPlan.treadmill.main.incline}</p>
                        <p><strong>Descripci√≥n:</strong> ${currentPlan.treadmill.main.description}</p>
                    `;
                }

                cooldownDetails.innerHTML = `
                    <p><strong>Duraci√≥n:</strong> ${currentPlan.treadmill.cooldown.duration} min</p>
                    <p><strong>Actividad:</strong> ${currentPlan.treadmill.cooldown.activity}. Incluye **estiramientos est√°ticos** para mejorar la flexibilidad y recuperaci√≥n.</p>
                    <p><strong>Velocidad:</strong> ${currentPlan.treadmill.cooldown.speed} km/h</p>
                    <p><strong>Inclinaci√≥n:</strong> ${currentPlan.treadmill.cooldown.incline}</p>
                `;
            }
        }

        // Function to render the compact weight progress section
        function renderWeightProgressSection() {
            const weekSelect = document.getElementById('weightWeekSelect');
            const currentWeekWeightInput = document.getElementById('currentWeekWeightInput');
            const saveButton = document.getElementById('saveCurrentWeekWeight');

            // Populate the select dropdown
            if (weekSelect) {
                weekSelect.innerHTML = ''; // Clear previous options
                for (let i = 1; i <= 12; i++) {
                    const option = document.createElement('option');
                    option.value = i;
                    option.textContent = `${i}`; // Just the week number
                    weekSelect.appendChild(option);
                }
                weekSelect.value = appState.selectedWeightWeek; // Set selected week
                weekSelect.onchange = (e) => {
                    appState.selectedWeightWeek = parseInt(e.target.value);
                    currentWeekWeightInput.value = weightProgress[`week${appState.selectedWeightWeek}`] || '';
                };
            }

            // Update input field based on selected week
            if (currentWeekWeightInput) {
                currentWeekWeightInput.value = weightProgress[`week${appState.selectedWeightWeek}`] || '';
            }

            if (saveButton) {
                saveButton.onclick = () => {
                    if (currentWeekWeightInput && !isNaN(parseFloat(currentWeekWeightInput.value))) {
                        weightProgress[`week${appState.selectedWeightWeek}`] = parseFloat(currentWeekWeightInput.value);
                        saveWeightProgress();
                        createWeightProgressChart(); // Update chart
                    }
                };
            }
        }


        function renderPlan() {
            const currentPlan = planData.find(p => p.week === appState.currentWeek);
            const currentPhaseData = `phase${currentPlan.phase}`;
            const currentStrengthPlan = strengthData[currentPhaseData];

            contentArea.innerHTML = `
                <div class="bg-white p-6 rounded-lg shadow-sm">
                    <h2 class="text-xl font-bold mb-4 text-blue-800">Mi Plan y Progreso</h2>
                    <p class="mb-6 text-zinc-600">Aqu√≠ puedes ver un resumen de tu estado, tu plan semanal y tu progresi√≥n a lo largo de las 12 semanas. Puedes ajustar tu peso para ver c√≥mo cambia tu IMC.</p>
                    
                    <div class="mb-6 flex items-center space-x-2">
                        <label for="week-selector" class="block font-semibold">Semana:</label>
                        <input type="number" id="week-selector" min="1" max="12" value="${appState.currentWeek}"
                               class="w-24 p-2 border border-blue-300 rounded-md shadow-sm text-center">
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6">
                        <div class="bg-blue-50 p-4 rounded-lg">
                            <h3 class="font-semibold text-blue-900">Peso Actual</h3>
                            <input type="number" id="weightInput" value="${userData.weight}" step="0.1" min="40" max="200" class="w-full mt-1 p-2 border border-blue-200 rounded-md text-2xl font-bold text-blue-700">
                        </div>
                        <div class="bg-blue-50 p-4 rounded-lg">
                            <h3 class="font-semibold text-blue-900">IMC</h3>
                            <p class="text-2xl font-bold text-blue-700" id="imcDisplay">${userData.imc}</p>
                            <span class="text-sm text-blue-600" id="conditionDisplay">${userData.condition}</span>
                        </div>
                        <div class="bg-blue-50 p-4 rounded-lg">
                            <h3 class="font-semibold text-blue-900">Estatura</h3>
                            <p class="text-2xl font-bold text-blue-700" id="heightDisplay">${userData.height} cm</p>
                        </div>
                        <div class="bg-yellow-50 p-4 rounded-lg">
                            <h3 class="font-semibold text-yellow-900">Estado de Recuperaci√≥n</h3>
                            <p class="text-md font-semibold text-yellow-800" id="recoveryStatus">${currentStrengthPlan.title}</p>
                            <p class="text-sm text-yellow-700" id="recoveryFocus">Foco: ${currentPlan.phase === 1 ? 'Cicatrizaci√≥n' : (currentPlan.phase === 2 ? 'Progresi√≥n controlada' : 'Rendimiento y fuerza')}</p>
                        </div>
                    </div>
                    
                    <div class="bg-zinc-50 p-4 rounded-lg mb-6">
                        <h3 class="text-lg font-semibold mb-2 text-zinc-800" id="treadmillWeekLabel">üéØ Entrenamiento de Trotadora de Hoy (Semana ${appState.currentWeek})</h3>
                        <div class="space-y-2">
                            <h4 class="font-semibold text-zinc-700 mt-2">Calentamiento:</h4>
                            <div id="warmupDetails" class="ml-4 text-sm text-zinc-600">
                                <p><strong>Duraci√≥n:</strong> ${currentPlan.treadmill.warmup.duration} min</p>
                                <p><strong>Actividad:</strong> ${currentPlan.treadmill.warmup.activity}. Incluye **ejercicios de movilidad articular controlada** y **estiramientos din√°micos** para preparar tus m√∫sculos.</p>
                                <p><strong>Velocidad:</strong> ${currentPlan.treadmill.warmup.speed} km/h</p>
                                <p><strong>Inclinaci√≥n:</strong> ${currentPlan.treadmill.warmup.incline}</p>
                            </div>
                            
                            <h4 class="font-semibold text-zinc-700 mt-2">Entrenamiento Principal:</h4>
                            <div id="mainExerciseDetails" class="ml-4 text-sm text-zinc-600">
                                <!-- Content will be dynamically updated based on treadmill.main.type -->
                            </div>

                            <h4 class="font-semibold text-zinc-700 mt-2">Enfriamiento:</h4>
                            <div id="cooldownDetails" class="ml-4 text-sm text-zinc-600">
                                <p><strong>Duraci√≥n:</strong> ${currentPlan.treadmill.cooldown.duration} min</p>
                                <p><strong>Actividad:</strong> ${currentPlan.treadmill.cooldown.activity}. Incluye **estiramientos est√°ticos** para mejorar la flexibilidad y recuperaci√≥n.</p>
                                <p><strong>Velocidad:</strong> ${currentPlan.treadmill.cooldown.speed} km/h</p>
                                <p><strong>Inclinaci√≥n:</strong> ${currentPlan.treadmill.cooldown.incline}</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="chart-container mb-2">
                        <canvas id="progressChart"></canvas>
                    </div>
                    <div class="text-center text-sm text-zinc-600 mb-8">
                        <p>Este gr√°fico muestra la progresi√≥n de la duraci√≥n total del entrenamiento (l√≠nea azul) y la velocidad m√°xima alcanzada en la trotadora (l√≠nea verde) a lo largo de las 12 semanas de tu plan.</p>
                    </div>

                    <div id="weekly-details" class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    </div>

                    <!-- New Weight Progress Section - Redesigned -->
                    <div class="bg-white p-6 rounded-lg shadow-sm mt-6">
                        <h2 class="text-xl font-bold mb-4 text-blue-800">üìä Mi Progreso de Peso Semanal</h2>
                        <p class="mb-4 text-zinc-600">Registra tu peso cada semana para visualizar tu progreso a lo largo del plan.</p>
                        
                        <div class="flex flex-col sm:flex-row items-end justify-between mb-4 space-y-3 sm:space-y-0 sm:space-x-4">
                            <div class="flex items-center space-x-2 w-full sm:w-1/2">
                                <label for="weightWeekSelect" class="text-sm font-medium text-zinc-700 whitespace-nowrap">Semana:</label>
                                <select id="weightWeekSelect" class="p-2 border border-blue-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-base w-full">
                                    <!-- Options will be populated by JavaScript -->
                                </select>
                            </div>
                            <div class="flex items-center space-x-2 w-full sm:w-1/2">
                                <label for="currentWeekWeightInput" class="text-sm font-medium text-zinc-700 whitespace-nowrap">Peso (Kg):</label>
                                <input type="number" id="currentWeekWeightInput" step="0.1" min="40" max="200"
                                       class="w-full p-3 border border-blue-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-lg"
                                       placeholder="Ej. 85.5">
                            </div>
                            <button id="saveCurrentWeekWeight" class="w-full sm:w-auto mt-4 sm:mt-0 px-6 py-3 bg-blue-600 text-white font-semibold rounded-md shadow-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition duration-150 ease-in-out">
                                Guardar Progreso
                            </button>
                        </div>

                        <div class="chart-container mt-4 mb-2">
                            <canvas id="weightProgressChart"></canvas>
                        </div>
                        <div class="text-center text-sm text-zinc-600 mb-8">
                            <p>Este gr√°fico muestra tu progreso de peso (en kg) a lo largo de las semanas, basado en los datos que ingreses. La semana se muestra en el eje horizontal y el peso en el eje vertical.</p>
                        </div>
                    </div>
                </div>
            `;
            renderWeeklyDetails(appState.currentWeek);
            updateSummaryCards(appState.currentWeek); // Initial call to populate details
            createProgressChart();
            renderWeightProgressSection(); // Call the new function here
            createWeightProgressChart(); // Call to create the new weight progress chart
            
            // Event listener for the new week selector
            const weekSelector = document.getElementById('week-selector');
            if (weekSelector) {
                weekSelector.addEventListener('change', (e) => {
                    let week = parseInt(e.target.value);
                    // Ensure the week is within bounds
                    if (week < 1) week = 1;
                    if (week > 12) week = 12;
                    e.target.value = week; // Update input value if it was out of bounds

                    appState.currentWeek = week;
                    renderWeeklyDetails(week);
                    updateSummaryCards(week); // Call to update the summary cards
                    appState.selectedWeightWeek = week; // Sync selected week for weight input
                    renderWeightProgressSection(); // Update the weight input and display for the new week
                });
            }

            document.getElementById('weightInput').addEventListener('input', updateUserDataDisplay);
        }
        
        function renderWeeklyDetails(week) {
            const weeklyDetailsContainer = document.getElementById('weekly-details');
            const plan = planData.find(p => p.week === week);
            const strengthPlanKey = `phase${plan.phase}`;
            const strength = strengthData[strengthPlanKey];

            let mainTreadmillDetailsHtml = '';
            if (plan.treadmill.main.type.includes("HIIT")) {
                mainTreadmillDetailsHtml = `
                    <p><strong>Tipo:</strong> ${plan.treadmill.main.type}</p>
                    <p><strong>Descripci√≥n:</strong> ${plan.treadmill.main.description}</p>
                    <ul class="list-disc list-inside ml-4">
                        <li><strong>Intervalos:</strong> ${plan.treadmill.main.intervalos} ciclos</li>
                        <li><strong>Esfuerzo:</strong> ${plan.treadmill.main.esfuerzo_duration} a ${plan.treadmill.main.esfuerzo_speed} km/h con ${plan.treadmill.main.esfuerzo_incline} de inclinaci√≥n</li>
                        <li><strong>Recuperaci√≥n:</strong> ${plan.treadmill.main.recuperacion_duration} a ${plan.treadmill.main.recuperacion_speed} km/h con ${plan.treadmill.main.recuperacion_incline} de inclinaci√≥n</li>
                        ${plan.treadmill.main.miss_duration ? `<li><strong>Sesi√≥n MISS/LISS Adicional:</strong> ${plan.treadmill.main.miss_duration || plan.treadmill.main.miss_liss_duration} min a ${plan.treadmill.main.miss_speed || plan.treadmill.main.miss_liss_speed} km/h con ${plan.treadmill.main.miss_incline || plan.treadmill.main.miss_liss_incline} de inclinaci√≥n</li>` : ''}
                    </ul>
                `;
            } else {
                mainTreadmillDetailsHtml = `
                    <p><strong>Tipo:</strong> ${plan.treadmill.main.type}</p>
                    <p><strong>Duraci√≥n:</strong> ${plan.treadmill.main.duration_total} min</p>
                    <p><strong>Velocidad:</strong> ${plan.treadmill.main.speed} km/h</p>
                    <p><strong>Inclinaci√≥n:</strong> ${plan.treadmill.main.incline}</p>
                    <p><strong>Descripci√≥n:</strong> ${plan.treadmill.main.description}</p>
                `;
            }

            weeklyDetailsContainer.innerHTML = `
                <div class="bg-zinc-50 p-4 rounded-lg border border-zinc-200">
                    <h3 class="text-lg font-semibold mb-2 text-zinc-800">üèÉ‚Äç‚ôÇÔ∏è Trotadora: Semana ${week}</h3>
                    <div class="space-y-2">
                        <p><strong>Fase del Plan:</strong> ${plan.phase} - ${strength.title.split(':')[0]}</p>
                        ${mainTreadmillDetailsHtml}
                        <p class="text-xs text-blue-600 mt-2">Recuerda realizar **ejercicios de movilidad articular controlada** y estiramientos din√°micos antes, y est√°ticos despu√©s de cada sesi√≥n.</p>
                    </div>
                </div>
                <div class="bg-zinc-50 p-4 rounded-lg border border-zinc-200">
                    <h3 class="text-lg font-semibold mb-2 text-zinc-800">üí™ Activaci√≥n y Fortalecimiento: Semana ${week}</h3>
                     <p class="text-sm text-zinc-600 mb-3">${strength.description}</p>
                    <ul class="space-y-2">
                        ${strength.exercises.map(ex => `
                            <li class="p-2 bg-white rounded-md">
                                <p class="font-semibold">${ex.name}</p>
                                <p class="text-sm text-zinc-600"><strong>Series/Repeticiones:</strong> ${ex.sets} x ${ex.reps}</p>
                                <p class="text-xs text-blue-600">${ex.note}</p>
                            </li>
                        `).join('')}
                    </ul>
                    <p class="text-xs text-blue-600 mt-2">Recuerda realizar **ejercicios de movilidad articular controlada** y estiramientos din√°micos antes, y est√°ticos despu√©s de cada sesi√≥n de fuerza.</p>
                </div>
            `;
        }

        let progressChartInstance;
        function createProgressChart() {
            const ctx = document.getElementById('progressChart').getContext('2d');
            if (progressChartInstance) {
                progressChartInstance.destroy();
            }

            const labels = planData.map(p => `Sem ${p.week}`);
            const durations = planData.map(p => {
                let mainTotal = 0;
                if (p.treadmill.main.type.includes("HIIT")) {
                    const effortDuration = parseInt(p.treadmill.main.esfuerzo_duration.replace(/[^0-9]/g, ''));
                    const recoveryDuration = parseInt(p.treadmill.main.recuperacion_duration.replace(/[^0-9]/g, ''));
                    mainTotal = p.treadmill.main.intervalos * (effortDuration + recoveryDuration);
                    if (p.treadmill.main.miss_duration) {
                        mainTotal += p.treadmill.main.miss_duration;
                    } else if (p.treadmill.main.miss_liss_duration) {
                        mainTotal += p.treadmill.main.miss_liss_duration;
                    }
                } else {
                    mainTotal = p.treadmill.main.duration_total;
                }
                return mainTotal + p.treadmill.warmup.duration + p.treadmill.cooldown.duration;
            });

            const maxSpeeds = planData.map(p => {
                let currentMaxSpeed = 0;
                if (p.treadmill.main.type.includes("HIIT")) {
                    // For HIIT, consider the peak speed during effort intervals
                    const effortSpeedStr = p.treadmill.main.esfuerzo_speed.toString();
                    currentMaxSpeed = parseFloat(effortSpeedStr.split('-')[1]); // e.g., from "10-12" get 12

                    // If there's an additional MISS/LISS session, consider its max speed too
                    if (p.treadmill.main.miss_speed) {
                        const missSpeedStr = p.treadmill.main.miss_speed.toString();
                        currentMaxSpeed = Math.max(currentMaxSpeed, parseFloat(missSpeedStr.split('-')[1]));
                    } else if (p.treadmill.main.miss_liss_speed) {
                        const missLissSpeedStr = p.treadmill.main.miss_liss_speed.toString();
                        currentMaxSpeed = Math.max(currentMaxSpeed, parseFloat(missLissSpeedStr.split('-')[1]));
                    }
                } else {
                    // For LISS/MISS, take the highest speed from the range
                    const speedStr = p.treadmill.main.speed.toString();
                    currentMaxSpeed = parseFloat(speedStr.split('-')[1]); // e.g., from "4.0-5.0" get 5.0
                }
                return currentMaxSpeed;
            });

            progressChartInstance = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Duraci√≥n Total (min)',
                        data: durations,
                        borderColor: '#2563eb',
                        backgroundColor: 'rgba(37, 99, 235, 0.1)',
                        fill: true,
                        yAxisID: 'y',
                    }, {
                        label: 'Velocidad M√°x (km/h)',
                        data: maxSpeeds,
                        borderColor: '#16a34a',
                        backgroundColor: 'rgba(22, 163, 74, 0.1)',
                        fill: false,
                        yAxisID: 'y1',
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            type: 'linear',
                            display: true,
                            position: 'left',
                            title: { display: true, text: 'Duraci√≥n Total (min)' }
                        },
                        y1: {
                            type: 'linear',
                            display: true,
                            position: 'right',
                            title: { display: true, text: 'Velocidad M√°x (km/h)' },
                            grid: { drawOnChartArea: false }
                        }
                    },
                    plugins: {
                        tooltip: {
                            mode: 'index',
                            intersect: false,
                        }
                    }
                }
            });
        }

        let weightProgressChartInstance;
        function createWeightProgressChart() {
            const ctx = document.getElementById('weightProgressChart').getContext('2d');
            if (weightProgressChartInstance) {
                weightProgressChartInstance.destroy();
            }

            const labels = [];
            const data = [];
            for (let i = 1; i <= 12; i++) {
                let labelText;
                if (i === 1) {
                    labelText = '1ra';
                } else if (i === 2) {
                    labelText = '2da';
                } else if (i === 3) {
                    labelText = '3ra';
                } else {
                    labelText = `${i}va`;
                }
                labels.push(labelText);
                data.push(weightProgress[`week${i}`] || null); // Use null for missing data points
            }

            weightProgressChartInstance = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Peso (kg)',
                        data: data,
                        borderColor: '#ef4444', // Red color for weight
                        backgroundColor: 'rgba(239, 68, 68, 0.1)',
                        fill: true,
                        tension: 0.1, // Smooth the line
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Mi progreso en la perdida de peso', // New title
                            font: {
                                size: 16
                            }
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false,
                        }
                    },
                    scales: {
                        x: {
                            type: 'category', // Weeks on X-axis
                            display: true,
                            title: {
                                display: true,
                                text: 'Semana'
                            }
                        },
                        y: {
                            type: 'linear', // Weight on Y-axis
                            display: true,
                            title: {
                                display: true,
                                text: 'Peso (kg)'
                            },
                            min: 70, // Set minimum to 70
                            max: 90, // Set maximum to 90
                            ticks: {
                                stepSize: 2, // Set step size to 2
                                autoSkip: false, // Disable auto-skipping of ticks
                                maxTicksLimit: 11 // Max ticks from 70 to 90 with step 2 is (90-70)/2 + 1 = 11
                            }
                        }
                    }
                }
            });
        }
        
        function renderSafety() {
            contentArea.innerHTML = `
                <div class="bg-white p-6 rounded-lg shadow-sm">
                    <h2 class="text-xl font-bold mb-2 text-blue-800">üõ°Ô∏è Progresi√≥n y Seguridad Post-Hernioplastia</h2>
                    <p class="mb-6 text-zinc-600">Esta secci√≥n es la m√°s importante para tu recuperaci√≥n. Sigue estas fases de forma estricta y escucha siempre a tu cuerpo. La ausencia de dolor es tu principal gu√≠a.</p>

                    <div class="space-y-4 mb-8">
                        <details class="group bg-zinc-50 p-4 rounded-lg border border-zinc-200">
                            <summary class="font-semibold text-lg cursor-pointer flex justify-between items-center">
                                Rehabilitaci√≥n Post-Hernioplastia: Evidencia Detallada
                                <span class="text-blue-600 text-sm group-open:hidden">Mostrar</span>
                                <span class="text-blue-600 text-sm hidden group-open:inline">Ocultar</span>
                            </summary>
                            <div class="mt-4 text-zinc-700 space-y-2">
                                <h4 class="font-semibold text-md text-blue-700">1. Importancia de la reparaci√≥n sin malla</h4>
                                <p class="text-sm">La hernioplastia crural sin malla, al basarse en la sutura directa de los tejidos, requiere una cicatrizaci√≥n natural y m√°s cautelosa. Esto implica un riesgo ligeramente mayor de recurrencia con esfuerzos prematuros, por lo que la progresi√≥n debe ser lenta y guiada por la ausencia de dolor. La consolidaci√≥n del tejido es clave para la integridad a largo plazo.</p>
                                <h4 class="font-semibold text-md text-blue-700">2. Ejercicios espec√≠ficos para el core Post-Hernioplastia</h4>
                                <p class="text-sm">El fortalecimiento del core es vital, pero debe evitarse la Maniobra de Valsalva (contener la respiraci√≥n durante el esfuerzo). Exhala siempre en la parte m√°s dif√≠cil del movimiento. Para una gu√≠a detallada de ejercicios de core, consulta la **Tabla 2** a continuaci√≥n.</p>
                            </div>
                        </details>
                    </div>

                    <h3 class="text-lg font-bold mt-8 mb-4 text-blue-800">Fases de Recuperaci√≥n y Retorno Progresivo a la Actividad F√≠sica</h3>
                    <p class="mb-6 text-zinc-600">Estas fases son cruciales para tu recuperaci√≥n. Sigue estas pautas estrictamente y escucha a tu cuerpo.</p>

                    <div class="space-y-4">
                        <details class="group bg-zinc-50 p-4 rounded-lg border border-zinc-200">
                            <summary class="font-semibold text-lg cursor-pointer flex justify-between items-center">
                                Fase 1: Recuperaci√≥n Inicial (0-2 Semanas)
                                <span class="text-blue-600 text-sm group-open:hidden">Mostrar</span>
                                <span class="text-blue-600 text-sm hidden group-open:inline">Ocultar</span>
                            </summary>
                            <div class="mt-4 text-zinc-700 space-y-2 text-sm">
                                <p><strong>Objetivo:</strong> Cicatrizaci√≥n, manejo del dolor y movimiento terap√©utico.</p>
                                <p><strong>‚úîÔ∏è Permitido:</strong> Caminatas muy cortas y lentas, subir escaleras con cuidado, ejercicios de respiraci√≥n profunda.</p>
                                <p><strong>‚ùå Evitar:</strong> CUALQUIER actividad extenuante, levantar objetos pesados, conducir if toma analg√©sicos.</p>
                            </div>
                        </details>

                        <details class="group bg-zinc-50 p-4 rounded-lg border border-zinc-200">
                            <summary class="font-semibold text-lg cursor-pointer flex justify-between items-center">
                                Fase 2: Movilidad y Fortalecimiento Moderado (2-6 Semanas)
                                <span class="text-blue-600 text-sm group-open:hidden">Mostrar</span>
                                <span class="text-blue-600 text-sm hidden group-open:inline">Ocultar</span>
                            </summary>
                            <div class="mt-4 text-zinc-700 space-y-2 text-sm">
                               <p><strong>Objetivo:</strong> Transici√≥n a la actividad controlada, restaurar funci√≥n sin comprometer la reparaci√≥n.</p>
                               <p><strong>‚úîÔ∏è Permitido:</strong> Aumentar caminatas a 20-30 min, bicicleta estacionaria o el√≠ptica (moderada, sin dolor), iniciar ejercicios de core b√°sicos (ver Tabla 2).</p>
                               <p><strong>‚ùå Evitar:</strong> Ejercicio intenso, levantar m√°s de 5 kg.</p>
                            </div>
                        </details>
                        
                        <details class="group bg-zinc-50 p-4 rounded-lg border border-zinc-200">
                            <summary class="font-semibold text-lg cursor-pointer flex justify-between items-center">
                                Fase 3: Retorno Progresivo a la Actividad Intensa (6 Semanas - 3 Meses)
                                <span class="text-blue-600 text-sm group-open:hidden">Mostrar</span>
                                <span class="text-blue-600 text-sm hidden group-open:inline">Ocultar</span>
                            </summary>
                             <div class="mt-4 text-zinc-700 space-y-2 text-sm">
                                <p><strong>Objetivo:</strong> Progresi√≥n cuidadosa en intensidad y volumen, consolidaci√≥n del tejido.</p>
                                <p><strong>‚úîÔ∏è Permitido:</strong> Aumento gradual de intensidad en caminata/trote, progresi√≥n de core, introducci√≥n de fuerza con peso corporal/bandas.</p>
                                <p><strong>‚ùå Evitar:</strong> Levantamiento de pesas significativas (hasta aprobaci√≥n m√©dica), deportes de contacto.</p>
                             </div>
                        </details>
                        <details class="group bg-zinc-50 p-4 rounded-lg border border-zinc-200">
                            <summary class="font-semibold text-lg cursor-pointer flex justify-between items-center">
                                Optimizaci√≥n y Rendimiento (3+ Meses)
                                <span class="text-blue-600 text-sm group-open:hidden">Mostrar</span>
                                <span class="text-blue-600 text-sm hidden group-open:inline">Ocultar</span>
                            </summary>
                             <div class="mt-4 text-zinc-700 space-y-2 text-sm">
                                <p><strong>Objetivo:</strong> Retorno a actividades previas y objetivos de rendimiento.</p>
                                <p><strong>‚úîÔ∏è Permitido:</strong> Reintroducci√≥n gradual de HIIT, entrenamiento de velocidad, entrenamiento de fuerza con pesas (progresi√≥n de cargas y ejercicios), deportes.</p>
                                <p><strong>‚ùå Evitar:</strong> Actividades que generen dolor o presi√≥n en la zona de la cirug√≠a.</p>
                             </div>
                        </details>
                    </div>

                    <h3 class="text-xl font-bold mt-8 mb-4 text-blue-800">Tabla 2: Ejercicios de Fortalecimiento del Core Post-Hernioplastia</h3>
                    <p class="mb-4 text-zinc-600">Esta tabla detalla los ejercicios de core recomendados, su progresi√≥n y notas de seguridad para tu recuperaci√≥n. Se incluyen ejercicios para estabilizadores locales (m√∫sculos m√°s profundos que controlan la estabilidad segmental) y globales (m√∫sculos m√°s superficiales que generan movimiento y resisten fuerzas externas).</p>
                    <div class="overflow-x-auto">
                        <table class="styled-table">
                            <thead>
                                <tr>
                                    <th>Ejercicio</th>
                                    <th>Descripci√≥n</th>
                                    <th>Nivel de Progresi√≥n</th>
                                    <th>Fase de Recuperaci√≥n Recomendada</th>
                                    <th>Notas de Seguridad</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${coreExercisesData.map(item => `
                                    <tr>
                                        <td><strong>${item.exercise}</strong></td>
                                        <td>${item.description}</td>
                                        <td>${item.progression}</td>
                                        <td>${item.phase}</td>
                                        <td>${item.notes}</td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
        }

        function renderScience() {
            contentArea.innerHTML = `
                <div class="bg-white p-6 rounded-lg shadow-sm">
                    <h2 class="text-xl font-bold mb-2 text-blue-800">üî¨ Fundamentos Cient√≠ficos Avanzados del Plan</h2>
                    <p class="mb-6 text-zinc-600">Profundiza en la ciencia detr√°s de tu plan de entrenamiento para entender c√≥mo cada aspecto contribuye a tus objetivos.</p>

                    <div class="space-y-4">
                        <details class="group bg-zinc-50 p-4 rounded-lg border border-zinc-200">
                            <summary class="font-semibold text-lg cursor-pointer flex justify-between items-center">
                                Investigaci√≥n Cient√≠fica Exhaustiva: Metodolog√≠a y Fuentes
                                <span class="text-blue-600 text-sm group-open:hidden">Mostrar</span>
                                <span class="text-blue-600 text-sm hidden group-open:inline">Ocultar</span>
                            </summary>
                            <div class="mt-4 text-zinc-700 space-y-2">
                                <p>Este plan ha sido dise√±ado bas√°ndose en una revisi√≥n exhaustiva de la literatura cient√≠fica disponible en bases de datos como PubMed, NCBI, Web of Science, SCOPUS, Google Scholar, SciELO, ERIC, BASE, DOAJ, ScienceDirect, Redalyc, Dialnet, JURN, Semantic Scholar y WorldWideScience. Se prioriz√≥ la evidencia de alta calidad, incluyendo revisiones sistem√°ticas, metaan√°lisis y ensayos controlados aleatorios, para asegurar que cada recomendaci√≥n est√© fundamentada en datos s√≥lidos y las mejores pr√°cticas actuales en fisiolog√≠a y neurociencia del ejercicio, as√≠ como en rehabilitaci√≥n.</p>
                            </div>
                        </details>

                        <details class="group bg-zinc-50 p-4 rounded-lg border border-zinc-200">
                            <summary class="font-semibold text-lg cursor-pointer flex justify-between items-center">
                                Fisiolog√≠a de la P√©rdida de Grasa: Profundizando
                                <span class="text-blue-600 text-sm group-open:hidden">Mostrar</span>
                                <span class="text-blue-600 text-sm hidden group-open:inline">Ocultar</span>
                            </summary>
                            <div class="mt-4 text-zinc-700 space-y-2">
                                <h4 class="font-semibold text-md text-blue-700">1. Mecanismos celulares de la oxidaci√≥n de grasa</h4>
                                <p class="text-sm">La oxidaci√≥n de grasas ocurre principalmente en las mitocondrias de las c√©lulas musculares. Los triglic√©ridos almacenados en el tejido adiposo son hidrolizados en √°cidos grasos libres y glicerol (lip√≥lisis), que luego son transportados a las c√©lulas musculares. Dentro de la mitocondria, los √°cidos grasos sufren beta-oxidaci√≥n para producir acetil-CoA, que entra en el ciclo de Krebs y la cadena de transporte de electrones para generar ATP (energ√≠a). El ejercicio, especialmente el aer√≥bico, estimula la expresi√≥n de enzimas involucradas en la beta-oxidaci√≥n y aumenta la densidad mitocondrial, mejorando la capacidad del m√∫sculo para quemar grasa.</p>
                                <h4 class="font-semibold text-md text-blue-700">2. Regulaci√≥n hormonal y el balance energ√©tico</h4>
                                <p class="text-sm">El balance energ√©tico est√° finamente regulado por un complejo sistema hormonal. Hormonas como la leptina (producida por el tejido adiposo, se√±al de saciedad), grelina (producida en el est√≥mago, se√±al de hambre), insulina (regula glucosa y almacenamiento de energ√≠a), y cortisol (hormona del estr√©s) interact√∫an para influir en el apetito, el metabolismo y el almacenamiento de grasa. Un d√©ficit cal√≥rico prolongado puede alterar estas hormonas, llevando a una "adaptaci√≥n metab√≥lica" que dificulta la p√©rdida de peso. El entrenamiento de fuerza y una ingesta adecuada de prote√≠nas ayudan a mitigar estos efectos, manteniendo el metabolismo activo y preservando la masa muscular.</p>
                            </div>
                        </details>

                        <details class="group bg-zinc-50 p-4 rounded-lg border border-zinc-200">
                            <summary class="font-semibold text-lg cursor-pointer flex justify-between items-center">
                                El Poder de la Inclinaci√≥n
                                <span class="text-blue-600 text-sm group-open:hidden">Mostrar</span>
                                <span class="text-blue-600 text-sm hidden group-open:inline">Ocultar</span>
                            </summary>
                            <div class="mt-4 text-zinc-700 space-y-2">
                                <p class="text-sm">La inclinaci√≥n en la trotadora es una herramienta potente para aumentar la intensidad del ejercicio sin necesidad de incrementar la velocidad, lo que reduce el impacto en las articulaciones. Esto es particularmente beneficioso para la p√©rdida de grasa, ya que eleva significativamente el gasto cal√≥rico y activa m√°s m√∫sculos de las piernas y gl√∫teos. Permite un entrenamiento cardiovascular desafiante con menor riesgo de estr√©s articular, ideal para la fase de recuperaci√≥n y para maximizar la quema de calor√≠as de forma segura.</p>
                            </div>
                        </details>

                        <details class="group bg-zinc-50 p-4 rounded-lg border border-zinc-200">
                            <summary class="font-semibold text-lg cursor-pointer flex justify-between items-center">
                                Cardio ¬øen Ayunas o Alimentado?
                                <span class="text-blue-600 text-sm group-open:hidden">Mostrar</span>
                                <span class="text-blue-600 text-sm hidden group-open:inline">Ocultar</span>
                            </summary>
                            <div class="mt-4 text-zinc-700 space-y-2">
                                <p class="text-sm">La investigaci√≥n actual sugiere que no hay una diferencia significativa en la p√©rdida de grasa total a largo plazo entre realizar cardio en ayunas o despu√©s de haber comido, siempre que el balance cal√≥rico diario sea el mismo. Si bien el cardio en ayunas puede aumentar la oxidaci√≥n de grasa durante la sesi√≥n, el cuerpo compensa esto a lo largo del d√≠a. La elecci√≥n debe basarse en la preferencia personal, la comodidad y el rendimiento individual, sin que sea un factor determinante para el √©xito en la p√©rdida de grasa.</p>
                            </div>
                        </details>

                        <details class="group bg-zinc-50 p-4 rounded-lg border border-zinc-200">
                            <summary class="font-semibold text-lg cursor-pointer flex justify-between items-center">
                                Modalidades de Entrenamiento: LISS, MISS y HIIT
                                <span class="text-blue-600 text-sm group-open:hidden">Mostrar</span>
                                <span class="text-blue-600 text-sm hidden group-open:inline">Ocultar</span>
                            </summary>
                            <div class="mt-4 text-zinc-700 space-y-2">
                                <p class="text-sm">La combinaci√≥n de diferentes intensidades maximiza los beneficios:</p>
                                <ul class="list-disc list-inside ml-4 mt-1 text-sm">
                                    <li><strong>LISS (Low-Intensity Steady State):</strong> Ejercicio de baja intensidad y duraci√≥n prolongada. Ideal para la recuperaci√≥n, mejora de la resistencia de base y quema de grasa sin alto impacto.</li>
                                    <li><strong>MISS (Moderate-Intensity Steady State):</strong> Intensidad moderada y constante. Ofrece un buen equilibrio entre gasto cal√≥rico y duraci√≥n, siendo un puente hacia mayores intensidades.</li>
                                    <li><strong>HIIT (High-Intensity Interval Training):</strong> Alterna r√°fagas cortas de m√°ximo esfuerzo con per√≠odos de recuperaci√≥n. Altamente eficiente en tiempo, mejora la capacidad cardiovascular y genera un "efecto postcombusti√≥n" (EPOC) que quema calor√≠as despu√©s del entrenamiento.</li>
                                </ul>
                            </div>
                        </details>

                        <details class="group bg-zinc-50 p-4 rounded-lg border border-zinc-200">
                            <summary class="font-semibold text-lg cursor-pointer flex justify-between items-center">
                                La Importancia de los M√∫sculos Estabilizadores (Locales y Globales) y los Ejercicios Isom√©tricos
                                <span class="text-blue-600 text-sm group-open:hidden">Mostrar</span>
                                <span class="text-blue-600 text-sm hidden group-open:inline">Ocultar</span>
                            </summary>
                            <div class="mt-4 text-zinc-700 space-y-2">
                                <p class="text-sm">Los m√∫sculos estabilizadores son esenciales para la eficiencia del movimiento, la prevenci√≥n de lesiones y la protecci√≥n de las articulaciones, especialmente la columna vertebral. Se dividen en:</p>
                                <ul class="list-disc list-inside ml-4 mt-1 text-sm">
                                    <li><strong>Estabilizadores Locales:</strong> M√∫sculos profundos (ej. transverso abdominal, mult√≠fido) que cruzan pocas articulaciones. Su funci√≥n principal es proporcionar estabilidad segmental y control fino, activ√°ndose a bajas cargas para mantener la alineaci√≥n articular.</li>
                                    <li><strong>Estabilizadores Globales:</strong> M√∫sculos m√°s superficiales (ej. recto abdominal, oblicuos externos) que cruzan m√∫ltiples articulaciones. Generan movimiento y resisten fuerzas externas mayores, influyendo en la postura y el control del movimiento general.</li>
                                </ul>
                                <p class="text-sm mt-2">La deficiencia en estos m√∫sculos aumenta el riesgo de lesiones, incluyendo el dolor lumbar. Aqu√≠ es donde los **ejercicios isom√©tricos** juegan un papel crucial:</p>
                                <ul class="list-disc list-inside ml-4 mt-1 text-sm">
                                    <li><strong>Activaci√≥n Espec√≠fica:</strong> Los isom√©tricos (contracciones musculares sin cambio de longitud ni movimiento articular) son ideales para activar y fortalecer selectivamente estos m√∫sculos estabilizadores, tanto locales como globales.</li>
                                    <li><strong>Estabilidad y Control Postural:</strong> Al mantener una posici√≥n est√°tica, se entrena al sistema nervioso para coordinar y sincronizar los m√∫sculos, mejorando la estabilidad muscular y el control postural.</li>
                                    <li><strong>Seguridad en la Rehabilitaci√≥n:</strong> Son de bajo impacto y no generan movimientos bruscos en las articulaciones, lo que los hace particularmente seguros y efectivos en fases de rehabilitaci√≥n, como la post-hernioplastia, permitiendo fortalecer la zona sin riesgo de tensi√≥n excesiva.</li>
                                    <li><strong>Eficiencia del Movimiento:</strong> Un core fuerte y estable, gracias a la activaci√≥n de estos m√∫sculos, permite que los m√∫sculos m√°s grandes (motores primarios) trabajen de manera m√°s eficiente, mejorando el rendimiento deportivo y reduciendo el riesgo de lesiones.</li>
                                </ul>
                                <p class="text-sm mt-2">Desde la perspectiva de la **neurociencia del ejercicio**, los isom√©tricos mejoran la **coordinaci√≥n intermuscular** y la **plasticidad motora**, es decir, la capacidad del sistema nervioso para adaptarse y optimizar el control de los movimientos. Esto se traduce en una mejor "comunicaci√≥n" entre el cerebro y los m√∫sculos, resultando en movimientos m√°s suaves, precisos y seguros.</p>
                            </div>
                        </details>
                        
                        <details class="group bg-zinc-50 p-4 rounded-lg border border-zinc-200">
                            <summary class="font-semibold text-lg cursor-pointer flex justify-between items-center">
                                Optimizaci√≥n del Entrenamiento
                                <span class="text-blue-600 text-sm group-open:hidden">Mostrar</span>
                                <span class="text-blue-600 text-sm hidden group-open:inline">Ocultar</span>
                            </summary>
                            <div class="mt-4 text-zinc-700 space-y-2">
                                <h4 class="font-semibold text-md text-blue-700">1. Adaptaciones neuromusculares y eficiencia del movimiento</h4>
                                <p class="text-sm">El entrenamiento no solo afecta el sistema cardiovascular, sino tambi√©n el neuromuscular. Con el tiempo, tu cuerpo mejorar√° la coordinaci√≥n inter e intramuscular, la activaci√≥n de unidades motoras y la eficiencia biomec√°nica. Esto significa que para la misma velocidad o carga, tu cuerpo gastar√° menos energ√≠a, volvi√©ndose m√°s eficiente. Para seguir progresando en la p√©rdida de grasa y el rendimiento, es crucial variar los est√≠mulos (velocidad, inclinaci√≥n, tipo de ejercicio, volumen de fuerza) para desafiar continuamente estas adaptaciones y evitar el estancamiento.</p>
                                <h4 class="font-semibold text-md text-blue-700">2. Sistemas energ√©ticos dominantes por intensidad</h4>
                                <p class="text-sm">El cuerpo utiliza diferentes sistemas energ√©ticos seg√∫n la intensidad y duraci√≥n del ejercicio:
                                    <ul class="list-disc list-inside ml-4 mt-1">
                                        <li><strong>Sistema de Fosf√°genos (ATP-PCr):</strong> Predomina en esfuerzos muy cortos y m√°ximos (ej. sprints de 5-10 segundos).</li>
                                        <li><strong>Gluc√≥lisis Anaer√≥bica:</strong> Para esfuerzos intensos de 10 segundos a 2 minutos (ej. intervalos HIIT).</li>
                                        <li><strong>Sistema Oxidativo (Aer√≥bico):</strong> Para esfuerzos de baja a moderada intensidad y larga duraci√≥n (ej. LISS, MISS), utilizando principalmente grasas y carbohidratos con ox√≠geno.</li>
                                    </ul>
                                    La combinaci√≥n de LISS, MISS y HIIT en tu plan asegura que se estimulen todos estos sistemas, maximizando la quema de calor√≠as y mejorando la capacidad metab√≥lica general.</p>
                            </div>
                        </details>

                        <details class="group bg-zinc-50 p-4 rounded-lg border border-zinc-200">
                            <summary class="font-semibold text-lg cursor-pointer flex justify-between items-center">
                                Nutrici√≥n para el Rendimiento y la Recuperaci√≥n
                                <span class="text-blue-600 text-sm group-open:hidden">Mostrar</span>
                                <span class="text-blue-600 text-sm hidden group-open:inline">Ocultar</span>
                            </summary>
                            <div class="mt-4 text-zinc-700 space-y-2">
                                <h4 class="font-semibold text-md text-blue-700">1. Macronutrientes: m√°s all√° del d√©ficit cal√≥rico</h4>
                                <p class="text-sm">Si bien el d√©ficit cal√≥rico es fundamental, la distribuci√≥n de macronutrientes es clave para la composici√≥n corporal y el rendimiento:
                                    <ul class="list-disc list-inside ml-4 mt-1">
                                        <li><strong>Prote√≠nas:</strong> Esenciales para la reparaci√≥n y crecimiento muscular, y para la saciedad. Apunta a 1.6-2.2 g/kg de peso corporal.</li>
                                        <li><strong>Carbohidratos:</strong> Principal fuente de energ√≠a para el ejercicio, especialmente en intensidades moderadas a altas. Prioriza carbohidratos complejos.</li>
                                        <li><strong>Grasas:</strong> Necesarias para la funci√≥n hormonal y la absorci√≥n de vitaminas. Prioriza grasas saludables.</li>
                                    </ul>
                                </p>
                                <h4 class="font-semibold text-md text-blue-700">2. Micronutrientes y hidrataci√≥n</h4>
                                <p class="text-sm">Vitaminas y minerales son vitales para el metabolismo energ√©tico, la funci√≥n inmunol√≥gica y la recuperaci√≥n. Una dieta variada rica en frutas, verduras y granos enteros es fundamental. La hidrataci√≥n adecuada es crucial para el rendimiento, la termorregulaci√≥n y la prevenci√≥n del estre√±imiento post-cirug√≠a. Bebe agua constantemente a lo largo del d√≠a.</p>
                            </div>
                        </details>

                        <details class="group bg-zinc-50 p-4 rounded-lg border border-zinc-200">
                            <summary class="font-semibold text-lg cursor-pointer flex justify-between items-center">
                                Elongaci√≥n y Flexibilidad: Fundamentos y Aplicaci√≥n
                                <span class="text-blue-600 text-sm group-open:hidden">Mostrar</span>
                                <span class="text-blue-600 text-sm hidden group-open:inline">Ocultar</span>
                            </summary>
                            <div class="mt-4 text-zinc-700 space-y-2">
                                <p class="text-sm">La elongaci√≥n y flexibilidad son componentes cruciales de un programa de entrenamiento integral, contribuyendo a la salud articular, la prevenci√≥n de lesiones y la mejora del rendimiento. La capacidad de una articulaci√≥n para moverse a trav√©s de su rango completo de movimiento (ROM) es fundamental para la eficiencia biomec√°nica y la reducci√≥n de la rigidez muscular.</p>
                                <h4 class="font-semibold text-md text-blue-700 mt-2">1. Beneficios de la Elongaci√≥n y Flexibilidad:</h4>
                                <ul class="list-disc list-inside ml-4 mt-1 text-sm">
                                    <li><strong>Mejora del Rango de Movimiento (ROM):</strong> Aumenta la capacidad de las articulaciones para moverse libremente, lo que es vital para la ejecuci√≥n correcta de los ejercicios y las actividades diarias.</li>
                                    <li><strong>Reducci√≥n de la Rigidez Muscular:</strong> Ayuda a disminuir la tensi√≥n en los m√∫sculos, lo que puede aliviar molestias y mejorar la postura.</li>
                                    <li><strong>Potencial Reducci√≥n del Riesgo de Lesiones:</strong> Aunque la evidencia es mixta, una buena flexibilidad puede contribuir a la prevenci√≥n de ciertas lesiones musculares y articulares, especialmente cuando se realiza de forma adecuada.</li>
                                    <li><strong>Mejora del Rendimiento Atl√©tico:</strong> Los estiramientos din√°micos antes del ejercicio pueden preparar los m√∫sculos, mientras que los estiramientos est√°ticos post-ejercicio pueden ayudar en la recuperaci√≥n.</li>
                                    <li><strong>Mejora de la Circulaci√≥n y Recuperaci√≥n:</strong> Contribuye a un mejor flujo sangu√≠neo y a la eliminaci√≥n de productos de desecho metab√≥licos, facilitando la recuperaci√≥n muscular.</li>
                                </ul>
                                <h4 class="font-semibold text-md text-blue-700 mt-2">2. Tipos de Estiramientos:</h4>
                                <ul class="list-disc list-inside ml-4 mt-1 text-sm">
                                    <li><strong>Estiramiento Din√°mico:</strong> Implica movimientos controlados que llevan las articulaciones a trav√©s de su rango de movimiento completo. Se recomienda como parte del calentamiento pre-ejercicio para preparar los m√∫sculos y aumentar la temperatura corporal. Ejemplos: balanceos de piernas, c√≠rculos de brazos, rotaciones de tronco suaves.</li>
                                    <li><strong>Estiramiento Est√°tico:</strong> Consiste en mantener una posici√≥n de estiramiento suave durante un per√≠odo de tiempo (generalmente 20-30 segundos) sin rebotes. Es m√°s efectivo cuando se realiza despu√©s del ejercicio, durante el enfriamiento, para mejorar la flexibilidad a largo plazo y reducir la rigidez muscular post-entrenamiento.</li>
                                    <li><strong>Facilitaci√≥n Neuromuscular Propioceptiva (FNP o PNF):</strong> Es una t√©cnica m√°s avanzada que combina estiramientos pasivos con contracciones isom√©tricas de los m√∫sculos. Es muy eficaz para aumentar el ROM, pero a menudo requiere la supervisi√≥n de un profesional debido a su complejidad.</li>
                                </ul>
                                <h4 class="font-semibold text-md text-blue-700 mt-2">3. Recomendaciones para tu Rutina:</h4>
                                <ul class="list-disc list-inside ml-4 mt-1 text-sm">
                                    <li><strong>Antes del Ejercicio (Calentamiento):</strong> Realiza de 5 a 10 minutos de estiramientos din√°micos. Esto prepara tus m√∫sculos para la actividad, mejora la movilidad articular y reduce el riesgo de lesiones.</li>
                                    <li><strong>Despu√©s del Ejercicio (Enfriamiento):</strong> Dedica de 5 a 10 minutos a estiramientos est√°ticos. Mant√©n cada estiramiento durante 20-30 segundos, sin sentir dolor, solo una tensi√≥n suave. Esto ayuda a mejorar la flexibilidad, reducir la rigidez y favorecer la recuperaci√≥n.</li>
                                    <li><strong>Consideraciones Post-Hernioplastia:</strong> En tu caso, es crucial que cualquier estiramiento, especialmente los que involucren la zona abdominal o inguinal, se realice con extrema precauci√≥n y sin generar ning√∫n tipo de dolor o presi√≥n en la zona de la cirug√≠a. Escucha a tu cuerpo y, ante la menor molestia, det√©n el estiramiento.</li>
                                </ul>
                            </div>
                        </details>

                        <details class="group bg-zinc-50 p-4 rounded-lg border border-zinc-200">
                            <summary class="font-semibold text-lg cursor-pointer flex justify-between items-center">
                                Movilidad Articular: Fundamentos y Aplicaci√≥n
                                <span class="text-blue-600 text-sm group-open:hidden">Mostrar</span>
                                <span class="text-blue-600 text-sm hidden group-open:inline">Ocultar</span>
                            </summary>
                            <div class="mt-4 text-zinc-700 space-y-2">
                                <p class="text-sm">La **movilidad articular** se refiere a la capacidad de una articulaci√≥n para moverse activamente a trav√©s de su rango completo de movimiento (ROM) con control y fuerza. Es distinta de la flexibilidad, que es el rango de movimiento pasivo de una articulaci√≥n. La movilidad articular se enfoca en la salud de la articulaci√≥n misma y su capacidad para moverse de manera eficiente bajo el control del sistema nervioso.</p>
                                <h4 class="font-semibold text-md text-blue-700 mt-2">1. Beneficios de la Movilidad Articular:</h4>
                                <ul class="list-disc list-inside ml-4 mt-1 text-sm">
                                    <li><strong>Mejora de la Salud Articular:</strong> Facilita la lubricaci√≥n de las articulaciones y la nutrici√≥n del cart√≠lago, promoviendo la salud a largo plazo.</li>
                                    <li><strong>Prevenci√≥n de Lesiones:</strong> Al mejorar el control y la estabilidad en el rango de movimiento, se reduce el riesgo de lesiones articulares y musculares, especialmente durante movimientos complejos o cargas.</li>
                                    <li><strong>Optimizaci√≥n del Rendimiento:</strong> Una buena movilidad articular permite ejecutar los ejercicios con una t√©cnica m√°s eficiente y un mayor rango de movimiento, lo que puede traducirse en una mayor activaci√≥n muscular y un mejor rendimiento deportivo.</li>
                                    <li><strong>Mejora de la Propiocepci√≥n:</strong> Aumenta la conciencia corporal sobre la posici√≥n y el movimiento de las articulaciones en el espacio, lo que es fundamental para la coordinaci√≥n y el equilibrio.</li>
                                    <li><strong>Reducci√≥n de la Rigidez y Dolor:</strong> Puede aliviar la rigidez articular y el dolor asociado, mejorando la calidad de vida y el movimiento diario.</li>
                                </ul>
                                <h4 class="font-semibold text-md text-blue-700 mt-2">2. Tipos de Ejercicios de Movilidad Articular:</h4>
                                <ul class="list-disc list-inside ml-4 mt-1 text-sm">
                                    <li><strong>Rotaciones Articulares Controladas (CARs):</strong> Son ejercicios donde se mueve una articulaci√≥n a trav√©s de su rango de movimiento m√°s amplio y controlado posible, con la intenci√≥n de "escanear" y mantener la salud de la c√°psula articular. Se realizan lentamente y con la m√°xima tensi√≥n controlada.</li>
                                    <li><strong>C√≠rculos Articulares:</strong> Movimientos circulares suaves de articulaciones como tobillos, rodillas, caderas, hombros y cuello.</li>
                                    <li><strong>Movimientos Segmentales:</strong> Ejercicios que a√≠slan el movimiento en una parte espec√≠fica de la columna vertebral (ej. rotaciones tor√°cicas).</li>
                                </ul>
                                <h4 class="font-semibold text-md text-blue-700 mt-2">3. Recomendaciones para tu Rutina:</h4>
                                <ul class="list-disc list-inside ml-4 mt-1 text-sm">
                                    <li><strong>Parte del Calentamiento:</strong> Realiza de 5 a 10 minutos de ejercicios de movilidad articular antes de tu calentamiento din√°mico y entrenamiento principal. Esto prepara tus articulaciones y el sistema nervioso para el movimiento. Enf√≥cate en las articulaciones clave para tu actividad (tobillos, caderas, columna tor√°cica, hombros).</li>
                                    <li><strong>Sesiones Independientes:</strong> La movilidad articular tambi√©n puede realizarse en sesiones separadas en d√≠as de descanso o como una rutina diaria corta para mantener la salud articular.</li>
                                    <li><strong>Consideraciones Post-Hernioplastia:</strong> Al igual que con los estiramientos, cualquier ejercicio de movilidad que involucre la zona abdominal o inguinal debe realizarse con extrema precauci√≥n. Evita cualquier movimiento que genere dolor, tensi√≥n o presi√≥n en la zona de la cirug√≠a. Prioriza la movilidad de otras articulaciones (tobillos, mu√±ecas, hombros, columna tor√°cica) y reintroduce la movilidad de cadera y columna lumbar de forma muy gradual y controlada.</li>
                                </ul>
                            </div>
                        </details>

                        <details class="group bg-zinc-50 p-4 rounded-lg border border-zinc-200">
                            <summary class="font-semibold text-lg cursor-pointer flex justify-between items-center">
                                Psicolog√≠a del Ejercicio: Estrategias Avanzadas de Adherencia
                                <span class="text-blue-600 text-sm group-open:hidden">Mostrar</span>
                                <span class="text-blue-600 text-sm hidden group-open:inline">Ocultar</span>
                            </summary>
                            <div class="mt-4 text-zinc-700 space-y-2">
                                <h4 class="font-semibold text-md text-blue-700">1. Teor√≠a de la autodeterminaci√≥n y motivaci√≥n intr√≠nseca</h4>
                                <p class="text-sm">Esta teor√≠a postula que la motivaci√≥n es m√°s sostenible cuando proviene de necesidades psicol√≥gicas b√°sicas:
                                    <ul class="list-disc list-inside ml-4 mt-1">
                                        <li><strong>Autonom√≠a:</strong> Sentir que eliges tus acciones (ej. flexibilidad de horario, elecci√≥n de MISS vs. LISS).</li>
                                        <li><strong>Competencia:</strong> Sentirte efectivo y capaz (ej. ver progreso en el gr√°fico, lograr objetivos semanales).</li>
                                        <li><strong>Relaci√≥n:</strong> Sentirte conectado con otros (ej. if entrenas con alguien, compartir logros).</li>
                                    </ul>
                                    Fomentar tu motivaci√≥n intr√≠nseca har√° que el ejercicio sea una fuente de disfrute, no solo una obligaci√≥n.</p>
                                <h4 class="font-semibold text-md text-blue-700">2. Estrategias cognitivo-conductuales para el cambio de h√°bito</h4>
                                <p class="text-sm">Estas estrategias te ayudan a cambiar patrones de pensamiento y comportamiento:
                                    <ul class="list-disc list-inside ml-4 mt-1">
                                        <li><strong>Establecimiento de metas:</strong> Metas SMART para un camino claro.</li>
                                        <li><strong>Auto-monitoreo:</strong> Registrar tu actividad y progreso.</li>
                                        <li><strong>Reestructuraci√≥n cognitiva:</strong> Cambiar pensamientos negativos sobre el ejercicio.</li>
                                        <li><strong>Manejo de contingencias:</strong> Recompensarte por cumplir metas.</li>
                                        <li><strong>Prevenci√≥n de reca√≠das:</strong> Planificar c√≥mo afrontar obst√°culos y desmotivaci√≥n.</li>
                                    </ul>
                                </p>
                            </div>
                        </details>
                    </div>
                </div>
            `;
        }
        
        const tabButtons = document.querySelectorAll('.tab-btn');

        function switchTab(tab) {
            appState.currentTab = tab;
            tabButtons.forEach(button => {
                if (button.dataset.tab === tab) {
                    button.classList.add('tab-active');
                } else {
                    button.classList.remove('tab-active');
                }
            });
            
            switch (tab) {
                case 'plan': // Only 'plan' now
                    renderPlan();
                    break;
                case 'safety':
                    renderSafety();
                    break;
                case 'science':
                    renderScience();
                    break;
            }
        }

        tabButtons.forEach(button => {
            button.addEventListener('click', () => {
                switchTab(button.dataset.tab);
            });
        });
        
        document.addEventListener('DOMContentLoaded', () => {
            switchTab('plan'); // Load 'plan' by default
        });

    </script>
</body>
</html>
